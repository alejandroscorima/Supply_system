<div class=" bg-amber-100 m-3 p-9" style="margin:20px; max-height:100%;" >


    <mat-tab-group class="w-full"  mat-stretch-tabs="false" mat-align-tabs="center" color="accent" [(selectedIndex)]="demo1TabIndex">
      
      <mat-tab label="NUEVA ORDEN" class=" w-full  " *ngIf="user_role!='SUPERVISOR'">
      
        <div class="w-full p-6 bg-white border border-gray-200 rounded-lg shadow
         dark:bg-gray-800 dark:border-gray-700">
      
          <a>
              <h5 class="mb-2 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white">
               EMPRESA</h5>
          </a>
  
  
          <div class="grid mb-8  rounded-lg
          md:mb-12 md:grid-cols-3 bg-white dark:bg-gray-800 ">
  
         <div class=" m-4">
            <label for="Tipos" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
              Elige el Tipo</label>
            <select id="TiposSelect" class=" w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm 
            rounded-lg focus:ring-blue-500 focus:border-blue-500 block  p-2.5 dark:bg-gray-700
          dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
              dark:focus:border-blue-500"   (change)="setActualType($event)" >
             
              <option id="optionTipo"
            *ngFor=" let t of types " (value)="t" onchange="setActualType(t)">
                <button type="button" (click)="setActualType(t)" >
                  {{t}}
                </button>
                
                </option>
              
            </select>
        </div>
           
  
  
        <div class=" m-4">
          <label for="destino" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Elige el destino</label>
          <select id="destino" class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm 
          rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700
           dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
            dark:focus:border-blue-500" (change)="setDestiny($event)">
             <option  *ngFor=" let c of campus " [value]="c['name']"  (selectionChange)="asigChange()" >{{c['name']}}</option>
           
          </select>
        </div>
  
        <div class=" m-4">
          <label for="moneda" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
            Tipo de moneda:</label>
          <select id="moneda" class=" w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm 
          rounded-lg focus:ring-blue-500 focus:border-blue-500 block  p-2.5 dark:bg-gray-700
        dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
            dark:focus:border-blue-500" (change)="setMoneda($event)" >
           
            <option *ngFor=" let m of monedas "  [value]="m">{{m}}</option>
            
          </select>
      </div>
      <div class=" m-4">
        <label for="condicion" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
          Condición de pago:</label>
        <select id="condicionSelect" class=" w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm 
        rounded-lg focus:ring-blue-500 focus:border-blue-500 block  p-2.5 dark:bg-gray-700
      dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
          dark:focus:border-blue-500" (change)="setCondicion($event)" >
         <option selected  [hidden]="ord.tipo_pago!=null" [value]="null"></option>
         <option *ngFor=" let p of pay_type "  [value]="p">{{p}}</option>
          
        </select>
    </div>
  
  <!-- 
              <mat-form-field class="sala" id="sala" appearance="outline" >
                <mat-label>Tipo:</mat-label>
                <mat-select [(value)]="ord.tipo" >
                    <mat-option *ngFor="let t of types" [value]="t">{{t}}</mat-option>
                </mat-select>
              </mat-form-field>
    
              <mat-form-field  class="sala" id="sala" appearance="outline" >
                <mat-label>Destino:</mat-label>
                <mat-select [(value)]="ord.destino" (selectionChange)="asigChange()">
                    <mat-option *ngFor="let c of campus" [value]="c['name']">{{c['name']}}</mat-option>
                </mat-select>
              </mat-form-field>
    
              <mat-form-field class="sala" id="sala" appearance="outline" >
                <mat-label>Moneda:</mat-label>
                <mat-select [(value)]="ord.moneda" (selectionChange)="asigMoneyChange()">
                    <mat-option *ngFor="let m of monedas" [value]="m">{{m}}</mat-option>
                </mat-select>
              </mat-form-field>
         <mat-form-field  class="sala" id="sala" appearance="outline" >
                <mat-label>Condiciones Pago:</mat-label>
                <mat-select [(value)]="ord.tipo_pago">
                    <mat-option *ngFor="let p of pay_type" [value]="p">{{p}}</mat-option>
                </mat-select>
              </mat-form-field>
   -->
              <mat-form-field appearance="outline">
                <mat-label>Fecha:</mat-label>
                <input matInput [matDatepicker]="dp3" disabled [(ngModel)]="fecha" #ref (dateChange)="dateChange()">
                <mat-datepicker-toggle matSuffix [for]="dp3"></mat-datepicker-toggle>
                <mat-datepicker #dp3 disabled="false"></mat-datepicker>
              </mat-form-field>
    
         
  
  
          </div>
    
        </div>  
  
  
  
  
  <!-- 
        <mat-card
        class=" mt-7 block max-w-full p-6 bg-white border border-gray-200 rounded-lg shadow
         hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700"
    >
  
  
  
          <mat-card-title>EMPRESA</mat-card-title>
  
          <mat-card-content>
            <mat-form-field style="width:22%" class="sala" id="sala" appearance="outline" >
              <mat-label>Tipo:</mat-label>
              <mat-select [(value)]="ord.tipo" >
                  <mat-option *ngFor="let t of types" [value]="t">{{t}}</mat-option>
              </mat-select>
            </mat-form-field>
  
            <mat-form-field style="width:22%;" class="sala" id="sala" appearance="outline" >
              <mat-label>Destino:</mat-label>
              <mat-select [(value)]="ord.destino" (selectionChange)="asigChange()">
                  <mat-option *ngFor="let c of campus" [value]="c['name']">{{c['name']}}</mat-option>
              </mat-select>
            </mat-form-field>
  
            <mat-form-field style="width:22%;" class="sala" id="sala" appearance="outline" >
              <mat-label>Moneda:</mat-label>
              <mat-select [(value)]="ord.moneda" (selectionChange)="asigMoneyChange()">
                  <mat-option *ngFor="let m of monedas" [value]="m">{{m}}</mat-option>
              </mat-select>
            </mat-form-field>
  
            <mat-form-field style="width:22%;" appearance="outline">
              <mat-label>Fecha:</mat-label>
              <input matInput [matDatepicker]="dp3" disabled [(ngModel)]="fecha" #ref (dateChange)="dateChange()">
              <mat-datepicker-toggle matSuffix [for]="dp3"></mat-datepicker-toggle>
              <mat-datepicker #dp3 disabled="false"></mat-datepicker>
            </mat-form-field>
  
            <mat-form-field style="width:22%;" class="sala" id="sala" appearance="outline" >
              <mat-label>Condiciones Pago:</mat-label>
              <mat-select [(value)]="ord.tipo_pago">
                  <mat-option *ngFor="let p of pay_type" [value]="p">{{p}}</mat-option>
              </mat-select>
            </mat-form-field>
          </mat-card-content>
        </mat-card>
  
  
  
   -->
  
   <div class="w-full p-6 bg-white border border-gray-200 rounded-lg shadow
   dark:bg-gray-800 dark:border-gray-700 my-4 ">
  
    <a>
        <h5 class="mb-2 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white">
         PROVEEDOR</h5>
    </a>
  
  
    <div class=" grid   rounded-lg
    md:mb-12 md:grid-cols-2 bg-white dark:bg-gray-800  ">
  
    <div class="mx-auto  min-w-7 ">
     <label for="large-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ingrese RUC</label>
     <input type="text" appIntegerPositive id="input-ruc" class="bg-gray-50 border border-gray-300
      text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block  w-full p-2.5
       dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
        dark:focus:border-blue-500"
  
       (keyup)="changeRuc()" [(ngModel)]="ord.ruc" placeholder="R.U.C."
       >
     </div>
  
     <div class="mx-auto w-full min-w-4">
       <label for="large-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ingrese Razón Social</label>
       <input type="text" id="default-input" class="bg-gray-50 border border-gray-300
        text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5
         dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
          dark:focus:border-blue-500"
  
        [(ngModel)]="ord.razon_social" placeholder="Razón Social."
         >
     </div>
  
     
   </div>
  
  
       <div class="mb-6">
         <label for="large-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ingrese Dirección</label>
         <input type="text" id="default-input" class="bg-gray-50 border border-gray-300
         text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5
         dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
         dark:focus:border-blue-500"
  
         [(ngModel)]="ord.direccion" placeholder="Dirección">
  
       </div>
  
  
       <div class="mb-6">
         <label for="large-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ingrese Cuenta Bancaria</label>
         <input type="text" id="default-input" class="bg-gray-50 border border-gray-300
         text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5
         dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
         dark:focus:border-blue-500"
  
           [(ngModel)]="ord.num_cuenta" placeholder="Nro de Cuenta Bancaria" >
  
       </div>
  
  
  
  
  
  
   </div>
  
  <!-- 
        <mat-card 
        class="block max-w-full p-6 mt-7 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700"
        
       >
          <mat-card-title>PROVEEDOR</mat-card-title>
          <mat-card-content>
            <mat-form-field style="width:32%;" class="doc_id" appearance="outline">
              <mat-label>RUC:</mat-label>
              <input matInput (keyup)="changeRuc()" [(ngModel)]="ord.ruc">
            </mat-form-field>
  
            <mat-form-field style="width:62%;" class="doc_id" appearance="outline">
              <mat-label>Razon social:</mat-label>
              <input matInput (keyup)="changeRazSoc()" [(ngModel)]="ord.razon_social">
            </mat-form-field>
  
            <mat-form-field style="width:94%;" class="doc_id" appearance="outline">
              <mat-label>Direccion:</mat-label>
              <input matInput [(ngModel)]="ord.direccion">
            </mat-form-field>
  
            <mat-form-field style="width:94%;" class="doc_id" appearance="outline">
              <mat-label>Número de Cuenta Bancaria:</mat-label>
              <input matInput [(ngModel)]="ord.num_cuenta">
            </mat-form-field>
          </mat-card-content>
        </mat-card>
       -->
  
  
        <div class="w-full p-6 bg-white border border-gray-200 rounded-lg shadow
        dark:bg-gray-800 dark:border-gray-700">
          <a>
              <h5 class="mb-2 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white">
                NUEVO ITEM</h5>
          </a>
          <div class=" mb-8  rounded-lg
          md:mb-12  grid md:grid-cols-9 gap-2 bg-white dark:bg-gray-800 " >
        
          
            <div class="max-w-xs mb-6 mx-auto col-span-2 flex flex-col ">
              <label for="quantity-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Cantidad:</label>
              <div class=" flex ">
                  <button type="button" id="decrement-button" class="bg-gray-100 dark:bg-gray-700
                  dark:hover:bg-gray-600 dark:border-gray-600 hover:bg-gray-200 border border-gray-300 rounded-s-lg p-3 h-11
                    focus:ring-gray-100 dark:focus:ring-gray-700 focus:ring-2 focus:outline-none"
                    (click)="decreaseQuantityButton()"
                    >
                      <svg class="w-3 h-3 text-gray-900 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 2">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h16"/>
                      </svg>
                  </button>
                  <input type="text"  appFloatPositive id="quantity-input" aria-describedby="helper-text-explanation" 
                  class="bg-gray-50 border-x-0 border-gray-300 h-11 text-center text-gray-900 text-sm focus:ring-blue-500
                  focus:border-blue-500 block w-full py-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 
                  dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="0" required
                  [(ngModel)]="orden_item.cantidad" placeholder="Cantidad"
                  >
                  <button type="button" id="increment-button"
                  class="bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 dark:border-gray-600 hover:bg-gray-200 border
                  border-gray-300 rounded-e-lg p-3 h-11 focus:ring-gray-100 dark:focus:ring-gray-700 focus:ring-2 focus:outline-none"
                  (click)="increaseQuantityButton()">
                      <svg class="w-3 h-3 text-gray-900 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 18">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 1v16M1 9h16"/>
                      </svg>
                  </button>
              </div>
            
          </div>
          
  
        
            <div class="mb-6 w-full mx-auto  col-span-5 flex flex-col">
              <label for="large-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ingrese la descripción del producto</label>
              <input type="text" id="default-input" class="bg-gray-50 border border-gray-300
              text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block  w-7/12 p-2.5
              dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
              dark:focus:border-blue-500"
        
              [(ngModel)]="orden_item.descripcion" placeholder="Descripcion"
              >
            </div>
        
            <div class="mb-6 mx-auto  w-full col-span-2 flex flex-col">
              <label for="large-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"> Precio</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600">
                <h1>{{prefijoMoney}}</h1>
                </span>
                <input type="text" appFloatPositive id="website-admin" class="rounded-none rounded-e-lg
                bg-gray-50 border border-gray-300 text-gray-900 focus:ring-blue-500 
                focus:border-blue-500 block flex-1 min-w-0 w-full text-sm p-2.5  dark:bg-gray-700
                dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
                  dark:focus:border-blue-500" placeholder="Precio"
                  [(ngModel)]="orden_item.unit_price" placeholder="Precio"
                  >
              </div>
  
            </div>  
  
            </div>
            <div class=" w-full text-right">
            
              <button type="button" class= " object-right
              text-white bg-gradient-to-br from-pink-500 to-orange-400 hover:bg-gradient-to-bl 
              focus:ring-4 focus:outline-none focus:ring-pink-200 dark:focus:ring-pink-800 font-medium rounded-lg 
              text-sm px-5 py-2.5 text-center me-2 mb-2bg-blue-700 hover:bg-blue-800  inline-flex 
              items-center  dark:bg-blue-600 dark:hover:bg-blue-700 "
              (click)="addItem()">
                <svg class="w-4 h-4 text-gray-800 dark:text-white mr-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 18">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 1v16M1 9h16"/>
                </svg>
                  Añadir Item 
                </button>
            </div>
          
      
  
        </div>
  
  
  <!-- 
        <mat-card 
        class="block max-w-full p-6 mt-7 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700"
        >
          <mat-card-title>Nuevo item</mat-card-title>
          <mat-card-content>
            <mat-form-field style="width:10%;" class="doc_id" appearance="outline">
              <mat-label>Cantidad:</mat-label>
              <input type="number" matInput [(ngModel)]="orden_item.cantidad">
            </mat-form-field>
  
            <mat-form-field style="width:50%;" appearance="outline">
              <mat-label>Descripcion:</mat-label>
              <input matInput [(ngModel)]="orden_item.descripcion">
            </mat-form-field>
  
            <mat-form-field style="width:15%;" appearance="outline">
              <mat-label>Precio Unit:</mat-label>
              <input matInput [(ngModel)]="orden_item.unit_price">
              <span matPrefix>{{prefijoMoney}}&nbsp;</span>
            </mat-form-field>
  
  
          </mat-card-content>
          <mat-card-actions align="end">
            <button mat-raised-button style="background-color: #b03a64; color:white" (click)="addItem()">
              <mat-icon>add</mat-icon>AGREGAR ITEM
            </button>
          </mat-card-actions>
        </mat-card>
  
   -->
  
  
  
    <div class="w-full p-6 mb-4 bg-white border border-gray-200 rounded-lg shadow
    *:dark:bg-gray-800 dark:border-gray-700 mt-4">
  
  
    <div style="width:100%;display:display-inline;text-align: center;">
      SUBIR ITEMS:
      {{docname}}
      <p style="align-content: center;text-align: center;">
        <input [(ngModel)]="fileUploaded" (change)="onFileChange($event)" #npt class="form-control" type="file" id="formFile" style="display: none;">
        <button (click)="npt.click()" mat-raised-button style="background-color: rgb(23, 71, 113); color:white;">
            <mat-icon>cloud_upload</mat-icon>
            CLICK AQUÍ
        </button>
      </p>
    </div>  
    <a>
        <h5 class="mb-2 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white">
        LISTA</h5>
    </a> 
  
    
    <div class="mat-elevation-z8" style="width:100%;">
      <table mat-table style="width:100%;" [dataSource]="dataSourceOrd" matSort>
  
        <ng-container matColumnDef="cantidad">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> CANTIDAD </th>
          <td mat-cell *matCellDef="let a"> {{a.cantidad}}</td>
        </ng-container>
  
        <ng-container matColumnDef="descripcion">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> DESCRIPCION </th>
          <td mat-cell *matCellDef="let a"> {{a.descripcion}}</td>
        </ng-container>
  
        <ng-container matColumnDef="unit_price">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> PRECIO UNIT </th>
          <td mat-cell *matCellDef="let a"> {{a.unit_price}}</td>
        </ng-container>
  
        <ng-container matColumnDef="subtotal">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> SUBTOTAL </th>
          <td mat-cell *matCellDef="let a"> {{a.subtotal}}</td>
        </ng-container>
  
        <ng-container matColumnDef="igv_toggle">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> IGV </th>
          <td mat-cell *matCellDef="let a">
            <mat-slide-toggle [checked]="a.igv_toggle" (change)="changeIgvToggleUnit(a)">
            </mat-slide-toggle>
            {{a.igv_unit}}
          </td>
        </ng-container>
  
  
        <ng-container matColumnDef="edit">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> </th>
          <td mat-cell *matCellDef="let a; let i=index">
            <button class="btnEdit" mat-icon-button focusable="false"  (click)="editItem(a,i)">
              <mat-icon>edit</mat-icon>
            </button>
            <button class="btnDel" mat-icon-button focusable="false"  (click)="deleteItem(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>
  
        <ng-container matColumnDef="empty2">
          <td mat-footer-cell *matFooterCellDef colspan="2">
          </td>
        </ng-container>
  
        <ng-container matColumnDef="empty1">
          <td mat-footer-cell *matFooterCellDef colspan="1">
          </td>
        </ng-container>
  
        <ng-container matColumnDef="subtotalO_label">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            SUBTOTAL
          </td>
        </ng-container>
  
        <ng-container matColumnDef="igv_label">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            <mat-checkbox [(ngModel)]="igvActivated" [disabled]="listaOrd.length==0"
              (ngModelChange)="updateIgv()">
            </mat-checkbox>
            IGV
            <mat-form-field style="width: 100px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
              <input (keyup)="changeIgv()" [disabled]="!igvActivated||(listaOrd.length==0)" matInput [(ngModel)]="ord.igv_percent">
            </mat-form-field>
            %
          </td>
        </ng-container>
  
        <!-- DEscuento -->
        <ng-container matColumnDef="desc_label">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            <mat-checkbox [(ngModel)]="descActivated" [disabled]="listaOrd.length==0"
              (ngModelChange)="updateIgv()">
            </mat-checkbox>
            Descuento
            <mat-form-field style="width: 100px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
              <input (keyup)="changeIgv()" [disabled]="!descActivated||(listaOrd.length==0) " matInput [(ngModel)]="ord.descuento">
            </mat-form-field>
            s/.
          </td>
        </ng-container>
  
  
  
  
        <ng-container matColumnDef="retencion_label">
          <td stye='text-align:right; align-content:right;' mat-footer-cell *matFooterCellDef colspan="1">
            <mat-checkbox [(ngModel)]="retencionActivated" [disabled]="listaOrd.length==0"
              (ngModelChange)="updateRetencion()">
            </mat-checkbox>
            Retención
            <mat-form-field style="width: 100px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
              <input (keyup)="changeRet()" [disabled]="!retencionActivated" matInput [(ngModel)]="ord.retencion_percent">
            </mat-form-field>
            %
          </td>
        </ng-container>
  
        <ng-container matColumnDef="percepcion_label">
          <td stye='text-align:right; align-content:right;' mat-footer-cell *matFooterCellDef colspan="1">
            <mat-checkbox [(ngModel)]="percepcionActivated" [disabled]="listaOrd.length==0"
              (ngModelChange)="updatePercepcion()">
            </mat-checkbox>
            Percepción
            <mat-form-field style="width: 100px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
              <input (keyup)="changePercep()" [disabled]="!percepcionActivated" matInput [(ngModel)]="percepInput">
            </mat-form-field>
          </td>
        </ng-container>
        
  
        <ng-container matColumnDef="igv_included">
          <td mat-footer-cell *matFooterCellDef colspan="2">
            <mat-slide-toggle [checked]="igvSlideChecked" [disabled]="igvSlideDisabled||listaOrd.length==0" (change)="change($event)">
              IGV incluido
            </mat-slide-toggle>
          </td>
        </ng-container>
  
        <!-- DESC ACTIVATE -->
  
        <ng-container matColumnDef="desc_included">
          <td mat-footer-cell *matFooterCellDef colspan="2">
            <mat-slide-toggle [checked]="descSlideChecked" [disabled]="descSlideDisabled||listaOrd.length==0" (change)="changedesc($event)">
              Descuento incluido
            </mat-slide-toggle>
          </td>
        </ng-container>
  
        <ng-container matColumnDef="total_label">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            TOTAL
          </td>
        </ng-container>
  
        <ng-container matColumnDef="subtotalO">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            {{ord.subtotal}}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="retencion">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            {{ord.retencion}}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="percepcion">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            {{ord.percepcion}}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="igv">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            {{ord.igv}}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="descuento">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            {{ord.descuento}}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="total">
          <td mat-footer-cell *matFooterCellDef colspan="1">
            {{ord.total}}
          </td>
        </ng-container>
  
  
        <tr mat-header-row *matHeaderRowDef="['cantidad','descripcion','unit_price','subtotal','igv_toggle','edit'];"></tr>
        <tr mat-row *matRowDef="let row; columns: ['cantidad','descripcion','unit_price','subtotal','igv_toggle','edit'];"></tr>
  
        <tr mat-footer-row *matFooterRowDef="['empty2','subtotalO_label','subtotalO','empty2']" style="font-weight: bold;" ></tr>
        <tr mat-footer-row *matFooterRowDef="['empty2','igv_label','igv','empty2']" style="font-weight: bold;" ></tr>
        <tr mat-footer-row *matFooterRowDef="['empty2','igv_included','empty2']" style="font-weight: bold;" ></tr>
  <!-- 
        <tr mat-footer-row *matFooterRowDef="['empty2','desc_label','descuento','empty2']" style="font-weight: bold;" ></tr>
        <tr mat-footer-row *matFooterRowDef="['empty2','desc_included','empty2']" style="font-weight: bold;" ></tr>
   -->
        <tr mat-footer-row *matFooterRowDef="['empty2','retencion_label','retencion','empty2']" style="font-weight: bold;" ></tr>
        <tr mat-footer-row *matFooterRowDef="['empty2','percepcion_label','percepcion','empty2']" style="font-weight: bold;" ></tr>
        <tr mat-footer-row *matFooterRowDef="['empty2','total_label','total','empty2']" style="font-weight: bold;" ></tr>
  
  
  
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="6">No se encontró "{{input1.value}}"</td>
        </tr>
      </table>
  
      <!-- <mat-paginator [pageSizeOptions]="[10, 20, 50, 100]" aria-label="Página"></mat-paginator> -->
    </div>
   
  
      <div  class="inline-flex w-full">
          <button mat-button style="width:76%; height:50px; padding: 0px ;margin:5px; text-align: right; padding-right: 10px;">
           MONTO INICIAL:{{' '+prefijoMoney}}
         </button>
          <mat-form-field style="width:13%; height:50px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
               <input matInput [(ngModel)]="ord.rebajado">
          </mat-form-field>
  
  
          
      <!--     <button mat-raised-button style="background-color:rgb(32, 142, 32); color: white; height:60px; width:25%"
          (click)="generarOrden()" >
            <mat-icon>check</mat-icon>Generar Orden
          </button>
   -->
  
  </div>
  
  
    </div>
  <!-- 
  
        <mat-card class="block max-w-full p-6 mt-7 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700"
        >
          <mat-card-title>Lista</mat-card-title>
          <mat-card-content>
  
            <div class="mat-elevation-z8" style="width:100%;">
                <table mat-table style="width:100%;" [dataSource]="dataSourceOrd" matSort>
  
                  <ng-container matColumnDef="cantidad">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> CANTIDAD </th>
                    <td mat-cell *matCellDef="let a"> {{a.cantidad}}</td>
                  </ng-container>
  
                  <ng-container matColumnDef="descripcion">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> DESCRIPCION </th>
                    <td mat-cell *matCellDef="let a"> {{a.descripcion}}</td>
                  </ng-container>
  
                  <ng-container matColumnDef="unit_price">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> PRECIO UNIT </th>
                    <td mat-cell *matCellDef="let a"> {{a.unit_price}}</td>
                  </ng-container>
  
                  <ng-container matColumnDef="subtotal">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> SUBTOTAL </th>
                    <td mat-cell *matCellDef="let a"> {{a.subtotal}}</td>
                  </ng-container>
  
                  <ng-container matColumnDef="igv_toggle">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> IGV </th>
                    <td mat-cell *matCellDef="let a">
                      <mat-slide-toggle [checked]="a.igv_toggle" (change)="changeIgvToggleUnit(a)">
                      </mat-slide-toggle>
                      {{a.igv_unit}}
                    </td>
                  </ng-container>
  
  
                  <ng-container matColumnDef="edit">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> </th>
                    <td mat-cell *matCellDef="let a; let i=index">
                      <button class="btnEdit" mat-icon-button focusable="false"  (click)="editItem(a,i)">
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button class="btnDel" mat-icon-button focusable="false"  (click)="deleteItem(i)">
                        <mat-icon>delete</mat-icon>
                      </button>
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="empty2">
                    <td mat-footer-cell *matFooterCellDef colspan="2">
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="empty1">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="subtotalO_label">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      SUBTOTAL
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="igv_label">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      <mat-checkbox [(ngModel)]="igvActivated" [disabled]="listaOrd.length==0"
                        (ngModelChange)="updateIgv()">
                      </mat-checkbox>
                      IGV
                      <mat-form-field style="width: 100px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
                        <input (keyup)="changeIgv()" [disabled]="!igvActivated||(listaOrd.length==0)" matInput [(ngModel)]="ord.igv_percent">
                      </mat-form-field>
                      %
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="retencion_label">
                    <td stye='text-align:right; align-content:right;' mat-footer-cell *matFooterCellDef colspan="1">
                      <mat-checkbox [(ngModel)]="retencionActivated" [disabled]="listaOrd.length==0"
                        (ngModelChange)="updateRetencion()">
                      </mat-checkbox>
                      Retención
                      <mat-form-field style="width: 100px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
                        <input (keyup)="changeRet()" [disabled]="!retencionActivated" matInput [(ngModel)]="ord.retencion_percent">
                      </mat-form-field>
                      %
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="percepcion_label">
                    <td stye='text-align:right; align-content:right;' mat-footer-cell *matFooterCellDef colspan="1">
                      <mat-checkbox [(ngModel)]="percepcionActivated" [disabled]="listaOrd.length==0"
                        (ngModelChange)="updatePercepcion()">
                      </mat-checkbox>
                      Percepción
                      <mat-form-field style="width: 100px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
                        <input (keyup)="changePercep()" [disabled]="!percepcionActivated" matInput [(ngModel)]="percepInput">
                      </mat-form-field>
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="igv_included">
                    <td mat-footer-cell *matFooterCellDef colspan="2">
                      <mat-slide-toggle [checked]="igvSlideChecked" [disabled]="igvSlideDisabled||listaOrd.length==0" (change)="change($event)">
                        IGV incluido
                      </mat-slide-toggle>
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="total_label">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      TOTAL
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="subtotalO">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      {{ord.subtotal}}
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="retencion">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      {{ord.retencion}}
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="percepcion">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      {{ord.percepcion}}
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="igv">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      {{ord.igv}}
                    </td>
                  </ng-container>
  
                  <ng-container matColumnDef="total">
                    <td mat-footer-cell *matFooterCellDef colspan="1">
                      {{ord.total}}
                    </td>
                  </ng-container>
  
  
                  <tr mat-header-row *matHeaderRowDef="['cantidad','descripcion','unit_price','subtotal','igv_toggle','edit'];"></tr>
                  <tr mat-row *matRowDef="let row; columns: ['cantidad','descripcion','unit_price','subtotal','igv_toggle','edit'];"></tr>
  
                  <tr mat-footer-row *matFooterRowDef="['empty2','subtotalO_label','subtotalO','empty2']" style="font-weight: bold;" ></tr>
                  <tr mat-footer-row *matFooterRowDef="['empty2','igv_label','igv','empty2']" style="font-weight: bold;" ></tr>
                  <tr mat-footer-row *matFooterRowDef="['empty2','igv_included','empty2']" style="font-weight: bold;" ></tr>
                  <tr mat-footer-row *matFooterRowDef="['empty2','retencion_label','retencion','empty2']" style="font-weight: bold;" ></tr>
                  <tr mat-footer-row *matFooterRowDef="['empty2','percepcion_label','percepcion','empty2']" style="font-weight: bold;" ></tr>
                  <tr mat-footer-row *matFooterRowDef="['empty2','total_label','total','empty2']" style="font-weight: bold;" ></tr>
  
  
  
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="6">No se encontró "{{input1.value}}"</td>
                  </tr>
                </table>
  
                
            </div>
          </mat-card-content>
  
  
  
          <mat-card-actions align="end">
  
  
            <button mat-button style="width:76%; height:50px; padding: 0px ;margin:5px; text-align: right; padding-right: 10px;">
              MONTO INICIAL:{{' '+prefijoMoney}}
            </button>
            <mat-form-field style="width:13%; height:50px; border-top:-15px; margin-bottom: -1.25em;" appearance="outline">
              <input matInput [(ngModel)]="ord.rebajado">
            </mat-form-field>
            <button mat-raised-button style="background-color:rgb(32, 142, 32); color: white; height:60px; width:25%" (click)="generarOrden()" >
              <mat-icon>check</mat-icon>Generar Orden
            </button>
  
  
  
  
          </mat-card-actions>
  
  
        </mat-card>
  
   -->
   
   
    <div class="w-full p-6 bg-white border border-gray-200 rounded-lg shadow
    dark:bg-gray-800 dark:border-gray-700">
      <a>
          <h5 class="mb-2 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white">
            Observaciones</h5>
      </a>
      <div class=" mb-4  rounded-lg md:mb-4  gap-2 bg-white dark:bg-gray-800 " >
    
    
        <div class="mb-2 w-full mx-auto  flex flex-col">
          <label for="large-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ingrese la observacion</label>
          <!-- <input type="text" id="default-input" class="bg-gray-50 border border-gray-300
          text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block  w-7/12 p-2.5
          dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500
          dark:focus:border-blue-500"
    
          [(ngModel)]="orden_item.descripcion" placeholder="Descripcion"
          > -->
          <textarea id="message" rows="4" class="block p-2.5 w-full text-sm text-gray-900
           bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700
            dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
             dark:focus:ring-blue-500 dark:focus:border-blue-500"
              placeholder="Escribe aqui..."
              [(ngModel)]="ord.observacion" placeholder="Descripcion"
              ></textarea>
           </div>
           
          
        </div>
        <div class=" w-full text-right">
            
          <button type="button" class="object-right
        font-medium rounded-lg 
          text-sm px-5 py-2.5 text-center me-2 mb-2bg-blue-700 gap-2 text-white bg-gradient-to-r 
          from-green-400 via-green-500 to-green-600 hover:bg-gradient-to-br focus:ring-4 
          focus:outline-none focus:ring-green-300 dark:focus:ring-green-800 shadow-lg
          shadow-green-500/50 dark:shadow-lg dark:shadow-green-800/80 b-2" (click)="generarOrden()">
          <svg class="w-6 h-6 text-white dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 21 21">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m6.072 10.072 2 2 6-4m3.586 4.314.9-.9a2 2 0 0 0 0-2.828l-.9-.9a2 
            2 0 0 1-.586-1.414V5.072a2 2 0 0 0-2-2H13.8a2 2 0 0 1-1.414-.586l-.9-.9a2 2 0 0 0-2.828 0l-.9.9a2 2 0 0 1-1.414.586H5.072a2 2 0 0 0-2 2v1.272a2 2 0 0 1-.586 1.414l-.9.9a2 
        2 0 0 0 0 2.828l.9.9a2 2 0 0 1 .586 1.414v1.272a2 2 0 0 0 2 2h1.272a2 2 0 0 1 1.414.586l.9.9a2 2 0 0 0 2.828 0l.9-.9a2 2 0 0 1 1.414-.586h1.272a2 2 0 0 0 2-2V13.8a2 2 0 0 1
         .586-1.414Z"/>
           </svg>
           Generar Orden
          </button>
        </div>
      
  
  
    </div>
  
  
  </mat-tab>

      <mat-tab label="VER ORDENES NEW V" class="tabWare">
  
        <mat-form-field style="width:40%;" appearance="outline" *ngIf="user_role=='SUPER ADMINISTRADOR' || user_role=='SUPERVISOR'">
          <mat-label>Destino:</mat-label>
          <mat-select [(ngModel)]="campusToView" [compareWith]="compareObjectsView" (selectionChange)="changeDestinoView()">
              <mat-option *ngFor="let cv of campusView" [value]="cv">{{cv.name}}</mat-option>
          </mat-select>
        </mat-form-field>
  
        <mat-form-field appearance="standard" style="display:display-inline">
            <mat-label>Búsqueda</mat-label>
            <input matInput (keyup)="applyFilterDView($event)" placeholder="Escribe algo para buscar" #input1>
        </mat-form-field>
  
        <button mat-raised-button *ngIf="user_role=='SUPER ADMINISTRADOR'" (click)="exporter.exportTable('xlsx',{fileName:'Ordenes compra/servicio'})"> EXPORTAR A EXCEL</button>
  
        <button type="button" class="text-white bg-gradient-to-br from-green-400 to-blue-600 hover:bg-gradient-to-bl focus:ring-4
        focus:outline-none focus:ring-green-200 dark:focus:ring-green-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center 
        me-2 mb-2" (click)="exportFilesToFolder()">
        Green to Blue</button>


        <div class="mat-elevation-z8" style="width:100%;">
            <table mat-table style="width:100%;" [dataSource]="dataSourceOrdersPendant" matSort multiTemplateDataRows matTableExporter #exporter="matTableExporter" [hiddenColumns]="[16,17,18,20,21]">
  
  
              <ng-container matColumnDef="check">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> CHECK </th>
                <td mat-cell *matCellDef="let a"> 
                  <div (click)="toggleCheckbox(a)">
                  <input type="checkbox" [checked]="a.isChecked" /> 
                </div>
                </td>
              </ng-container>
  
              <ng-container matColumnDef="fecha">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> FECHA </th>
                <td mat-cell *matCellDef="let a"> {{a.fecha}}</td>
              </ng-container>
  
              <ng-container matColumnDef="area">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> AREA </th>
                <td mat-cell *matCellDef="let a"> {{a.area}}</td>
              </ng-container>
  
              <ng-container matColumnDef="tipo">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> TIPO </th>
                <td mat-cell *matCellDef="let a"> {{a.tipo}}</td>
              </ng-container>
  
              <ng-container matColumnDef="numero">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> NUMERO </th>
                <td mat-cell *matCellDef="let a"> {{a.numero}}</td>
              </ng-container>
  
              <ng-container matColumnDef="empresa">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> RAZON SOCIAL </th>
                <td mat-cell *matCellDef="let a"> {{a.empresa}}</td>
              </ng-container>
  
              <ng-container matColumnDef="destino">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> DESTINO </th>
                <td mat-cell *matCellDef="let a"> {{a.destino}}</td>
              </ng-container>
  
              <ng-container matColumnDef="observacion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> OBSERVACIONES </th>
                <td mat-cell *matCellDef="let a"> {{a.observacion}}</td>
              </ng-container>
  
              <ng-container matColumnDef="ruc">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PROVEEDOR </th>
                <td mat-cell *matCellDef="let a"> {{a.ruc}}</td>
              </ng-container>
  
              <ng-container matColumnDef="razon_social">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> RAZ. SOC. PROVEEDOR </th>
                <td mat-cell *matCellDef="let a"> {{a.razon_social}}</td>
              </ng-container>
  
              <ng-container matColumnDef="tipo_pago">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> TIPO DE PAGO </th>
                <td mat-cell *matCellDef="let a"> {{a.tipo_pago}}</td>
              </ng-container>
  
              <ng-container matColumnDef="moneda">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> MONEDA </th>
                <td mat-cell *matCellDef="let a"> {{a.moneda}}</td>
              </ng-container>
  
              <ng-container matColumnDef="subtotal">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> SUBTOTAL </th>
                <td mat-cell *matCellDef="let a"> {{a.subtotal}}</td>
              </ng-container>
  
              <ng-container matColumnDef="igv">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> IGV </th>
                <td mat-cell *matCellDef="let a"> {{a.igv}}</td>
              </ng-container>
  
              <ng-container matColumnDef="total">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> TOTAL </th>
                <td mat-cell *matCellDef="let a"> {{a.total}}</td>
              </ng-container>
  
              <ng-container matColumnDef="rebajado">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> MONTO INICIAL </th>
                <td mat-cell *matCellDef="let a"> {{a.rebajado}}</td>
              </ng-container>
  
              <ng-container matColumnDef="retencion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> RETENCION </th>
                <td mat-cell *matCellDef="let a"> {{a.retencion}}</td>
              </ng-container>
  
              <ng-container matColumnDef="percepcion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PERCEPCION </th>
                <td mat-cell *matCellDef="let a"> {{a.percepcion}}</td>
              </ng-container>
  
              <ng-container matColumnDef="pdf">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PDF </th>
                <td mat-cell *matCellDef="let a">
                  <button mat-button color="accent" (click)="reCreatePDFView(a)">
                    <mat-icon>description</mat-icon>
                  </button>
                </td>
              </ng-container>
  
              <ng-container matColumnDef="edit">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> ANULAR </th>
                <td mat-cell *matCellDef="let a; let i=index">
                  <button *ngIf="a.estado!='ANULADO'" mat-icon-button color="primary" (click)="anularView(a)"> <mat-icon> cancel </mat-icon> </button>&nbsp;
                </td>
              </ng-container>
  
              <ng-container matColumnDef="receipt">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> COMPROBANTE </th>
                <td mat-cell *matCellDef="let a; let i=index">
                  <button *ngIf="a.receipt=='NO'" mat-icon-button (click)="addReceiptView(a)">  <mat-icon> receipt_long </mat-icon></button>
                  <button *ngIf="a.receipt=='SI'" mat-icon-button (click)="editReceiptView(a)">  <mat-icon> edit </mat-icon></button>
                </td>
              </ng-container>
  
              <ng-container matColumnDef="comprobante">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> NUMERO </th>
                <td mat-cell *matCellDef="let a"> {{a.comprobante}}</td>
              </ng-container>
  
              <ng-container matColumnDef="txt">
                <th mat-header-cell *matHeaderCellDef > TXT 
                  <button mat-icon-button color="primary" (click)="createTxtFile()"> <mat-icon> save_alt </mat-icon> </button>
                </th>
                <td mat-cell *matCellDef="let a; let i=index">
                  <mat-checkbox class="example-margin" (change)="listTxtChange($event,a)"
                  [checked]="selectionTxt.isSelected(a)" [disabled]="a.txt=='SI'"></mat-checkbox>&nbsp;
                </td>
              </ng-container>
  
              <ng-container matColumnDef="docs">
                <th mat-header-cell *matHeaderCellDef> DOCS </th>
                <td mat-cell *matCellDef="let a; let i=index" >
                  <div  class="drop-zone"
                  cdkDropList
                  (cdkDropListDropped)="onDrop($event)">
                    <button mat-button (click)="showDocs(a)">
                      <mat-icon>folder</mat-icon>
                    </button>
                  </div>
                </td>
              </ng-container>
              <ng-container matColumnDef="validar">
                <th mat-header-cell *matHeaderCellDef class=" items-center">
                  <p *ngIf="(user_role!='SUPERVISOR')" class="w-full h-full justify-center">VALIDADO</p>
                  <p *ngIf="(user_role=='SUPERVISOR')"class="w-full h-full justify-center">VALIDAR</p>
                </th>
                <td mat-cell *matCellDef="let a; let i=index">
                  <div *ngIf="(a.status!='PENDIENTE')&&(user_role!='SUPERVISOR')">
                    {{a.status}}
                  </div>
                  <div *ngIf="(a.val_state!='PENDIENTE')">
                    {{a.val_state}}
                  </div>
                  <div  *ngIf="(a.val_state=='PENDIENTE')&&(user_role=='SUPERVISOR')&&(setValidatorUser(a))&&(a.val_state!='ANULADO')">
                    <button mat-button (click)="validateButton(a,'VALIDAR')">
                      <mat-icon class="text-lime-500">checked</mat-icon>
                    </button>
                    <button mat-button (click)="validateButton(a,'RECHAZADO')">
                      <mat-icon class="text-red-500">cancel</mat-icon>
                    </button>
                  </div>
                  <div>
                    <button (click)="viewStatusButton(a)"> <mat-icon class="text-red-500">search</mat-icon> sts</button>
                  </div>
  
                </td>
              </ng-container>
                  
              <tr mat-header-row *matHeaderRowDef="columnsToShow"></tr>
              <tr mat-row *matRowDef="let row; columns: columnsToShow;"></tr>
  
  
  
              <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="6">No se encontró "{{input1.value}}"</td>
              </tr>
            </table>
  
            <mat-paginator [pageSizeOptions]="[10, 20, 50, 100]" aria-label="Página"></mat-paginator>
  
  
  
        </div>
        
        <hr class="h-px my-8 bg-gray-200 border-0 dark:bg-gray-700">
  
        <div class="mat-elevation-z8" style="width:100%;">
          <table mat-table style="width:100%;" [dataSource]="dataSourceOrdersView" matSort multiTemplateDataRows matTableExporter #exporter="matTableExporter" [hiddenColumns]="[16,17,18,20,21]">


            <ng-container matColumnDef="check">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> CHECK </th>
              <td mat-cell *matCellDef="let a"> 
                <div (click)="toggleCheckbox(a)">
                <input type="checkbox" [checked]="a.isChecked" /> 
              </div>
              </td>
            </ng-container>

            <ng-container matColumnDef="fecha">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> FECHA </th>
              <td mat-cell *matCellDef="let a"> {{a.fecha}}</td>
            </ng-container>

            <ng-container matColumnDef="area">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> AREA </th>
              <td mat-cell *matCellDef="let a"> {{a.area}}</td>
            </ng-container>

            <ng-container matColumnDef="tipo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> TIPO </th>
              <td mat-cell *matCellDef="let a"> {{a.tipo}}</td>
            </ng-container>

            <ng-container matColumnDef="numero">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> NUMERO </th>
              <td mat-cell *matCellDef="let a"> {{a.numero}}</td>
            </ng-container>

            <ng-container matColumnDef="empresa">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> RAZON SOCIAL </th>
              <td mat-cell *matCellDef="let a"> {{a.empresa}}</td>
            </ng-container>

            <ng-container matColumnDef="destino">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> DESTINO </th>
              <td mat-cell *matCellDef="let a"> {{a.destino}}</td>
            </ng-container>

            <ng-container matColumnDef="observacion">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> OBSERVACIONES </th>
              <td mat-cell *matCellDef="let a"> {{a.observacion}}</td>
            </ng-container>

            <ng-container matColumnDef="ruc">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> PROVEEDOR </th>
              <td mat-cell *matCellDef="let a"> {{a.ruc}}</td>
            </ng-container>

            <ng-container matColumnDef="razon_social">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> RAZ. SOC. PROVEEDOR </th>
              <td mat-cell *matCellDef="let a"> {{a.razon_social}}</td>
            </ng-container>

            <ng-container matColumnDef="tipo_pago">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> TIPO DE PAGO </th>
              <td mat-cell *matCellDef="let a"> {{a.tipo_pago}}</td>
            </ng-container>

            <ng-container matColumnDef="moneda">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> MONEDA </th>
              <td mat-cell *matCellDef="let a"> {{a.moneda}}</td>
            </ng-container>

            <ng-container matColumnDef="subtotal">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> SUBTOTAL </th>
              <td mat-cell *matCellDef="let a"> {{a.subtotal}}</td>
            </ng-container>

            <ng-container matColumnDef="igv">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> IGV </th>
              <td mat-cell *matCellDef="let a"> {{a.igv}}</td>
            </ng-container>

            <ng-container matColumnDef="total">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> TOTAL </th>
              <td mat-cell *matCellDef="let a"> {{a.total}}</td>
            </ng-container>

            <ng-container matColumnDef="rebajado">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> MONTO INICIAL </th>
              <td mat-cell *matCellDef="let a"> {{a.rebajado}}</td>
            </ng-container>

            <ng-container matColumnDef="retencion">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> RETENCION </th>
              <td mat-cell *matCellDef="let a"> {{a.retencion}}</td>
            </ng-container>

            <ng-container matColumnDef="percepcion">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> PERCEPCION </th>
              <td mat-cell *matCellDef="let a"> {{a.percepcion}}</td>
            </ng-container>

            <ng-container matColumnDef="pdf">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> PDF </th>
              <td mat-cell *matCellDef="let a">
                <button mat-button color="accent" (click)="reCreatePDFView(a)">
                  <mat-icon>description</mat-icon>
                </button>
              </td>
            </ng-container>

            <ng-container matColumnDef="edit">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> ANULAR </th>
              <td mat-cell *matCellDef="let a; let i=index">
                <button *ngIf="a.estado!='ANULADO'" mat-icon-button color="primary" (click)="anularView(a)"> <mat-icon> cancel </mat-icon> </button>&nbsp;
              </td>
            </ng-container>

            <ng-container matColumnDef="receipt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> COMPROBANTE </th>
              <td mat-cell *matCellDef="let a; let i=index">
                <button *ngIf="a.receipt=='NO'" mat-icon-button (click)="addReceiptView(a)">  <mat-icon> receipt_long </mat-icon></button>
                <button *ngIf="a.receipt=='SI'" mat-icon-button (click)="editReceiptView(a)">  <mat-icon> edit </mat-icon></button>
              </td>
            </ng-container>

            <ng-container matColumnDef="comprobante">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> NUMERO </th>
              <td mat-cell *matCellDef="let a"> {{a.comprobante}}</td>
            </ng-container>

            <ng-container matColumnDef="txt">
              <th mat-header-cell *matHeaderCellDef > TXT 
                <button mat-icon-button color="primary" (click)="createTxtFile()"> <mat-icon> save_alt </mat-icon> </button>
              </th>
              <td mat-cell *matCellDef="let a; let i=index">
                <mat-checkbox class="example-margin" (change)="listTxtChange($event,a)"
                [checked]="selectionTxt.isSelected(a)" [disabled]="a.txt=='SI'"></mat-checkbox>&nbsp;
              </td>
            </ng-container>

            <ng-container matColumnDef="docs">
              <th mat-header-cell *matHeaderCellDef> DOCS </th>
              <td mat-cell *matCellDef="let a; let i=index" >
                <div  class="drop-zone"
                cdkDropList
                (cdkDropListDropped)="onDrop($event)">
                  <button mat-button (click)="showDocs(a)">
                    <mat-icon>folder</mat-icon>
                  </button>
                </div>
              </td>
            </ng-container>
            <ng-container matColumnDef="validar">
              <th mat-header-cell *matHeaderCellDef class=" items-center">
                <p *ngIf="(user_role!='SUPERVISOR')" class="w-full h-full justify-center">VALIDADO</p>
                <p *ngIf="(user_role=='SUPERVISOR')"class="w-full h-full justify-center">VALIDAR</p>
              </th>
              <td mat-cell *matCellDef="let a; let i=index">
                <div *ngIf="(a.status!='PENDIENTE')&&(user_role!='SUPERVISOR')">
                  {{a.status}}
                </div>
                <div *ngIf="(a.val_state!='PENDIENTE')">
                  {{a.val_state}}
                </div>
                <div  *ngIf="(a.val_state=='PENDIENTE')&&(user_role=='SUPERVISOR')&&(setValidatorUser(a))&&(a.val_state!='ANULADO')">
                  <button mat-button (click)="validateButton(a,'VALIDAR')">
                    <mat-icon class="text-lime-500">checked</mat-icon>
                  </button>
                  <button mat-button (click)="validateButton(a,'RECHAZADO')">
                    <mat-icon class="text-red-500">cancel</mat-icon>
                  </button>
                </div>
                <div>
                  <button (click)="viewStatusButton(a)"> <mat-icon class="text-red-500">search</mat-icon> sts</button>
                </div>

              </td>
            </ng-container>
                
            <tr mat-header-row *matHeaderRowDef="columnsToShowTb2"></tr>
            <tr mat-row *matRowDef="let row; columns: columnsToShowTb2;"></tr>



            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="6">No se encontró "{{input1.value}}"</td>
            </tr>
          </table>

          <mat-paginator [pageSizeOptions]="[10, 20, 50, 100]" aria-label="Página"></mat-paginator>



      </div>
  
  
      </mat-tab>
  
    </mat-tab-group>
  
  
  
  
  
                  <!-- Modal  POPUP toggle -->
          <button  id="PopUpButton" data-modal-target="popup-modal" data-modal-toggle="popup-modal" 
          class=" hidden text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none
          focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center" type="button">
              V
          </button>
          <!-- Modal  POPUP  -->
          <div id="popup-modal" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
              <div class="relative p-4 w-full max-w-md max-h-full">
                  <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                      <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="popup-modal">
                          <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                          </svg>
                          <span class="sr-only">Close modal</span>
                      </button>
                      <div class="p-4 md:p-5 text-center">
                          <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                          </svg>
                          <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400" 
                              *ngIf="isAccepting=='VALIDAR'">Seguro que quiere VALIDAR esta solicitud?</h3>
                          <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400"
                              *ngIf="isAccepting=='RECHAZAR'">Seguro que quiere RECHAZAR esta solicitud?</h3>
  
                          <button data-modal-hide="popup-modal" type="button"
                          class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300
                          font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center me-2"
                          [ngClass]="{'bg-red-600': isAccepting !== 'VALIDAR', 'bg-green-600': isAccepting === 'VALIDAR',
                          'hover:bg-red-800': isAccepting !== 'VALIDAR', 'hover:bg-green-800': isAccepting === 'VALIDAR',
                          'focus:ring-red-300': isAccepting !== 'VALIDAR', 'focus:ring-green-300': isAccepting === 'VALIDAR'}"
                          (click)="changeStatus(isAccepting)">
  
                              SI, estoy seguro
                          </button>
  
                          <button data-modal-hide="popup-modal" type="button" class="text-gray-500 bg-white hover:bg-gray-100
                          focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium
                          px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500
                          dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                              No, cancelar</button>
                      </div>
                  </div>
              </div>
          </div>
  
  
                <!-- Modal  viewModal toggle -->
                <button  id="viewModalButton" data-modal-target="viewModal-modal" data-modal-toggle="viewModal-modal" 
                class=" hidden text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none
                focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center" type="button">
                    V
                </button>
                <!-- Modal  viewModal  -->
        <div id="viewModal-modal" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                    <div class="relative p-4 w-full max-w-md max-h-full">
                        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                            <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="viewModal-modal">
                                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                </svg>
                                <span class="sr-only">Close modal</span>
                            </button>
                            
                            <div class="p-4 md:p-5 text-center" *ngFor=" let val of validationsOrd" >
                              <p>{{val.first_name}} {{val.paternal_surname}}: {{val['state']}}</p>
                            </div>
                        </div>
                    </div>
                </div>
        
          
          
  
  
  
  
  
  
  </div>
  
  
  